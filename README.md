# geoframe-subbasin-explorer

**GEOframe Subbasin Explorer** is a desktop application (Java Swing) designed to explore and visualize **rainfall–runoff model outputs**, including states, fluxes, discharge and water-balance diagnostics, produced within the **GEOframe framework**, linked to a basin spatial representation stored in a **GeoPackage**.

The application allows interactive inspection of **subbasins / HRUs**, river networks, lakes and stream gauges, and provides visual access to **model states, fluxes, discharge time series, and water-balance components** across multiple hydrological domains.

The tool is intended primarily for **research, model development, and diagnostic analysis**, but is designed to remain flexible and extensible.

---

## Main capabilities

- Load a **GeoPackage** containing basin geometry and attributes
- Visualize:
  - subbasins / HRUs (polygons)
  - river network (lines)
  - stream gauges (points)
  - lakes / reservoirs (optional)
- Interactive selection of spatial elements
- Visual exploration of:
  - simulated vs observed discharge (where gauges are available)
  - model **state variables**
  - model **fluxes**
  - aggregated **water balances**
- Support for multiple **hydrological domains** (snow, soil, groundwater, etc.)
- Export of plots and tables *(planned)*

---

## Hydrological domains, states and fluxes

The application is **domain-oriented**, following the conceptual structure typically used in GEOframe-based rainfall–runoff models.

Each domain groups **state variables** (storages) and **fluxes** (exchanges per time step), which can be visualized consistently across subbasins and time periods.

### Supported / typical domains

#### Snow
- **States**
  - Snow Water Equivalent (SWE)
  - (optional) liquid water in snowpack
- **Fluxes**
  - snowfall
  - rainfall
  - precipitation

#### Canopy
- **States**
  - canopy water storage / interception storage
- **Fluxes**
  - interception
  - throughfall
  - evaporation from canopy

#### Root zone (soil / vadose zone)
- **States**
  - root-zone water content
- **Fluxes**
  - infiltration
  - evapotranspiration
  - percolation / recharge to groundwater

#### Runoff and routing
- **States**
  - runoff reservoir storages (e.g. fast / slow reservoirs)
- **Fluxes**
  - surface runoff

#### Groundwater
- **States**
  - groundwater storage (single for now)
- **Fluxes**
  - recharge from rootzone
  - groundwater outflow / baseflow
  - (optional) river–aquifer exchange

#### Lake / reservoir (optional)
- **States**
  - lake storage or water level
- **Fluxes**
  - inflow
  - outflow
  - evaporation

---

## States vs fluxes

- **States** represent stored water volumes or contents (e.g. SWE, soil water, reservoir storage).
- **Fluxes** represent water exchanges per time step (e.g. recharge, runoff, ET, melt).

The viewer typically displays:
- **States** as time series and bar charts (snapshot at selected times)
- **Fluxes** as time series and aggregated volumes
- **Balances** as period summaries (inputs, outputs, and storage changes)

---

## Data inputs

### 1) Spatial data (GeoPackage)

A GeoPackage (`.gpkg`) containing at least a polygon layer representing the basin subdivision.

#### Required layer
- **Subbasins / HRUs** (polygons), with several attributes as for example geomorphological or classification attributes
(e.g. area, elevation, slope, land cover) of the HRU, if the HRU is a lake, if it contains the stream gauge.


#### Recommended layers
- **Rivers** (lines)
- **Stream gauges** (points)

#### Minimum required attributes
Layer and field names are configurable, but a stable identifier is required.

**Subbasins / HRUs**
- `sub_id` — unique identifier (integer or string)

**Stream gauges**
- `gauge_id` — unique identifier
- (optional) `sub_id` — link to associated subbasin


---

## Model outputs (GEOframe)

The application is designed to visualize outputs generated by **GEOframe rainfall–runoff workflows**.

Currently supported / expected formats:
- SQLite / GeoPackage tables

Future extensions may include:
- **CSV time series** (recommended for initial versions)

---

## Usage workflow

1. Start the application
2. **Load GeoPackage** containing basin geometry
4. Toggle visible layers (subbasins, rivers, gauges, lakes)
5. Select a spatial element:
   - **Subbasin / HRU** → inspect states, fluxes, balances
   - **Gauge** → compare simulated vs observed discharge
6. Adjust time window and aggregation settings

---

## Roadmap

- [ ] GeoPackage loader and attribute mapping
- [ ] Interactive basin view (pan / zoom / selection)
- [ ] Time series plotting (Qsim vs Qobs)
- [ ] States visualization (bar charts, snapshots)
- [ ] Water balance summaries
- [ ] Export plots and tables
- [ ] Performance improvements and caching

---

## Project status

This project is under active development and currently hosted on the author’s personal page.
If the software matures and proves broadly useful, it may be migrated to a different
repository or organizational space.

---

## License

This project is released under the **GNU General Public License v3.0 (GPL-3.0)**.

You are free to use, modify, and redistribute the software under the terms of the GPLv3. See the `LICENSE` file for details.

---

## Acknowledgements

- GEOframe developers and contributors
